\section{Моделирование скважины}
Моделирование работы скважины подразумевает расчет распределения давления и температуры в скважине с учетом конструкции скважины и скважинного оборудования. 

Для моделирования скважины требуется задание достаточно большого набора параметров. Попытка уместить эти параметры в функцию, которую можно вызвать из рабочего листа Excel приводит к достаточно сложному поведению функции. Более того от версии к версии поведение может меняться (хотя авторы стараются этого избежать). Поэтому наилучшим способом изучения поведения функций являются эксперименты и изучение кода. Данное описание не претендует на полному. Тем не менее отметим некоторые особенности функций расчета скважины, про которые полезно знать.

\begin{itemize}
	\item Модуль  \mintinline{vb.net}{u7_Excel_functions_well} содержит все функции расчета скважин.
	\item PVT параметры задаются с использованием PVT строки (функция \mintinline{vb.net}{PVT_encode()}). Если PVT строку не задать, расчет проводится для PVT параметров принятых по умолчанию (будут параметры похожие на параметры Приобского месторождения). 
	\item функция умеет учитывать наличие систем механизированной добычи в скважине. Определяется параметром  \mintinline{vb.net}{str_AL}), который должен быть сформирован функциями \mintinline{vb.net}{ESP_encode()}) для ЭЦН или \mintinline{vb.net}{GL_encode()}) для газлифтного метода. Если строку не задать расчёт будет проводиться для фонтанирующей скважины.
	\item  Конструкция скважины может быть задана с использованием числовых параметров глубины скважины, диаметров НКТ и ЭК, либо с использованием массивов (объектов range) содержащих инклинометрию и распределение диаметров по глубине. 
	\item  Модель расчета скважины поддерживает три варианта расчеты температуры - линейную интерполяцию температуры по измеренной глубине, задание температуры окружающей среды от вертикальной глубины и расчет температуры флюида с учетом эмиссии тепла в окружающее пространство где температура задана от вертикальной глубины. Третий вариант расчета самый медленный (требует решения системы двух уравнений на давлений и температуру совместно).
	\item  Модель скважины допускает калибровку с использованием параметров калибровки многофазного потока, параметров калибровки систем мех добычи и калибровки штуцера.
	\item  Все функции с моделями скважин поддерживают вывод расширенного набора параметров с использованием выходных массивов.
\end{itemize}

\subsection{Расчет снизу вверх}
\putlisting{listings/well_plin_pwf_atma.lst}


\subsection{Расчет cверху вниз}
\putlisting{listings/well_pwf_plin_atma.lst}

\section{Расчет узлового анализа}

\putlisting{listings/nodal_pwf_atma.lst}
